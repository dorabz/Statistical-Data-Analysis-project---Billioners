---
title: "SAP - projekt - Milijarderi"
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'projekt_sap_dokumentacija.pdf'))})
subtitle: "Uspjeh učenika u nastavi"
author: "Dora Bezuk, Marcela Matas, Josip Arelic, Domagoj Marinello"
date: "13.11.2022."
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library("readxl")
library(tidyverse)
library(dplyr)
```

# Uvod

Pitanja:

1. Ima li neki kontinent statistički značajno više miljarda?

2. Jesu li milijarderi koji su nasljedili bogastvo statistički značajno bogatiji od onih koji nisu?

3. Možete li iz danih varijabli predvidjeti njihovo bogatstvo?

4. Kada biste birali karijeru isključivo prema kriteriju da se obogatite, koju biste industriju izabrali?

Dodatna pitanja:

5. ???



# Deskriptivna analiza

```{r include=FALSE}
# Učitavanje podataka iz excel datoteke
# Promijeniti path u put do datoteke s podacima
bill_data <- read_excel("billionaires.xlsx")
```

```{r include=FALSE}
dim(bill_data) # dimenzije: 2614 redaka i 22 stupaca
names(bill_data) # imena stupaca
view(bill_data)

# klase pojedinih stupaca
sapply(bill_data, class)

# klasa tablice
class(bill_data) 
# zaključak: bill_data podaci su dobro učitani
```

```{r}
# Pomoćna funkcija za izbacivanje stršećih vrijednosti
remove_outliers <- function(data, data_column) {
  quartiles <- quantile(data_column, probs=c(.25, .75), na.rm = FALSE)
  IQR <- IQR(data_column)
  Lower <- quartiles[1] - 1.5*IQR
  Upper <- quartiles[2] + 1.5*IQR 
  
  return(subset(data, data_column >= Lower & data_column <= Upper))
}

cat('\n Dimenzija podataka: ', dim(bill_data))
```



```{r}
for (col_name in names(bill_data)){
  if (sum(is.na(bill_data[,col_name])) > 0){
    cat('Ukupno nedostajućih vrijednosti za varijablu'
        ,col_name, ': ', sum(is.na(bill_data[,col_name])),'\n')
  }
}

```


Postoje podaci koji nedostaju. Što s njima?


# Pitanja

## 1. Ima li neki kontinent statistički značajno više miljarda?


## 2. Jesu li milijarderi koji su nasljedili bogastvo statistički značajno bogatiji od onih koji nisu?

```{r}
# Učitavanje podataka iz excel datoteke

inherited = bill_data[bill_data$wealth.how.inherited!="not inherited",]
print(inherited)
non_inherited = bill_data[bill_data$wealth.how.inherited=="not inherited",]
print(non_inherited)
inherited_mean = mean(inherited$`wealth.worth in billions`)
print(inherited_mean)
hist(inherited$`wealth.worth in billions`, breaks = 20)
non_inherited_mean = mean(non_inherited$`wealth.worth in billions`)
print(non_inherited_mean)
hist(non_inherited$`wealth.worth in billions`, breaks = 20)
boxplot(inherited$`wealth.worth in billions`)
boxplot(non_inherited$`wealth.worth in billions`)
wilcox.test(inherited_mean, non_inherited_mean, alternative = "two.sided")

# jel smijem odrezat dio podataka (pogledati histogram i box plot), koji dio? 
# ako ne, koji test koristi? t-test za mediane umjesto meana? ili neparametarski test? kao sto je wilcoxon?
```

### Formiranje hipoteza

#### Vizualizacija podataka

### Pretpostavke za provođenje testa

#### Test xy

### Provođenje T-testa

### Zaključak



## 3. Možete li iz danih varijabli predvidjeti njihovo bogatstvo?

 + je li dobro tu koristiti sve milijardere s popisa 2014 + milijarderi s prethodnih popisa (ako nisu na popisu iz 2014. godine)

## 4. Kada biste birali karijeru isključivo prema kriteriju da se obogatite, koju biste industriju izabrali?

Pretpostavljamo da karijerom u određenoj industriji, a ne nasljedstvom zarađujemo novac. Zbog toga gledamo samo milijardere koji nisu nasljedili svoje bogatstvo.
Također, zanimaju nas samo najnoviji milijarderi odnosno oni s popisa iz 2014. godine.

 + kako prikazati trend kroz godine na grafu (dijagram paralelnih koordinata?)
 + možda gledati razliku iz popisa 2014 i 2001, odnosno nove milijardere - pa napraviti raspodjelu industrija novonastalih milijardera

```{r}
#
non_inherited_2014 <- non_inherited[non_inherited$year == 2014,]

par(mar=c(10,5,1,1))
barplot(sort(table(subset(non_inherited_2014$wealth.how.industry, non_inherited_2014$wealth.how.industry != "0")), decreasing = TRUE),
        main = "Billionaires distribution by industry (non-inherited wealth)",
        las = 2)
```

